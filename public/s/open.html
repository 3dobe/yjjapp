
<!-- css -->
<style>
	#canvas {
		width: 140px;
		height: 40px;
	}
    #form-open input[name="valisum"] {
        padding: 10px;
        height: auto;
        font-size: 20px;
    }
</style>

<div id="main-wrapper">
	<h1>申请讲座</h1>

	<form id="form-open">
        <div class="form-group">
            <canvas id="canvas" width="70" height="20"></canvas><br />
        </div>
		<div class="form-group">
            <input type="text" class="form-control" name="valisum" placeholder="输入图中的运算答案">
		</div>
	</form>

	<!--<form>
	    <input type="password" placeholder="重置密码">
        <button type="button" class="btn btn-primary btn-lg active">提交</button>
    </form>-->

<button type="submit" class="btn btn-primary btn-lg btn-block" data-toggle="modal" data-target="#myModal">
开启讲座
</button>

<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">讲座信息</h4>
            </div>
            <div class="modal-body">
               <div>


                    <input type="password" class="form-control" placeholder="请输入密码">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary">保存</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->






<!-- js -->
<script src="/lib/js/drawVerificationCode.js"></script>
<script>
	showValicode();

    var $formOpen = $('#form-open');
    $formOpen.ajaxForm({
		type: 'post',
		url: '/do/s/open',
		success: function(resObj) {
			var ok = resObj['ok'],
				msg = resObj['msg'];
			if (ok) {
				loadFrame('#/view');
			} else {
				alert(msg);
				showValicode();
			}
            $formOpen[0].reset();
		}
	});

	function showValicode() {
		$.ajax({
			type: 'get',
			url: '/do/valicode',
			data: {
				'action': 'open'
			},
			success: function(resObj) {
				var num1 = resObj['num1'], num2 = resObj['num2'], oper = resObj['oper'];
				drawVerificationCode(num1, num2, oper);
			}
		});
	}
</script>


