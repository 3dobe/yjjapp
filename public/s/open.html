
<!-- css -->
<style>
	#canvas {
		width: 140px;
		height: 40px;
	}
    #form-open input[name="valisum"] {
        padding: 10px;
        height: auto;
        font-size: 20px;
    }
    #form-open [type="submit"] {
        margin: auto;
        width: 140px;
    }
</style>

<div id="main-wrapper">
	<h1>申请讲座</h1>

	<form id="form-open">
        <div class="form-group">
            <canvas id="canvas" width="70" height="20"></canvas><br />
        </div>
		<div class="form-group">
            <input type="text" class="form-control" name="valisum" placeholder="验证码">
		</div>
        <div type="submit">
            <span class="button-wrap">
                <a class="button button-circle button-primary">创建</a>
            </span>
        </div>
	</form>

	<!--<form>
	    <input type="password" placeholder="重置密码">
        <button type="button" class="btn btn-primary btn-lg active">提交</button>
    </form>-->
</div>

<!-- js -->
<script src="/lib/js/drawVerificationCode.js"></script>
<script>
	showValicode();

    var $formOpen = $('#form-open');
    $formOpen.ajaxForm({
		type: 'post',
		url: '/do/s/open',
		success: function(resObj) {
			var ok = resObj['ok'],
				msg = resObj['msg'];
			if (ok) {
				loadFrame('#/view');
			} else {
				alert(msg);
				showValicode();
			}
            $formOpen[0].reset();
		}
	});

	function showValicode() {
		$.ajax({
			type: 'get',
			url: '/do/valicode',
			data: {
				'action': 'open'
			},
			success: function(resObj) {
				var num1 = resObj['num1'], num2 = resObj['num2'], oper = resObj['oper'];
				drawVerificationCode(num1, num2, oper);
			}
		});
	}
</script>


